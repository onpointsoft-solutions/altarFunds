{% extends "auth/base_auth.html" %}

{% block title %}Register Church - AltarFunds{% endblock %}

{% block content %}
<div class="auth-form-wrapper">
    <div class="auth-form-container">
        <div class="auth-tabs">
            <a href="{% url 'auth:login' %}" class="btn">Sign In</a>
            <a href="{% url 'auth:register' %}" class="btn">Register</a>
            <a href="#" class="btn active">Register Church</a>
        </div>
        <div class="auth-form-content">
            <h2 class="auth-title">Register Your Church</h2>
            <p class="auth-subtitle">Complete your church registration and upload legal documents</p>
            
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}

            <form method="post" enctype="multipart/form-data" class="auth-form">
                {% csrf_token %}
                
                <!-- Church Information Tab -->
                <div class="tab-content" id="church-info">
                    <h5 class="mb-3">
                        <i class="fas fa-church me-2"></i>Church Information
                    </h5>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.name.id_for_label }}" class="form-label">Church Name *</label>
                            {{ form.name }}
                            {% if form.name.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.name.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.denomination.id_for_label }}" class="form-label">Denomination *</label>
                            {{ form.denomination }}
                            {% if form.denomination.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.denomination.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.phone_number.id_for_label }}" class="form-label">Phone Number *</label>
                            {{ form.phone_number }}
                            {% if form.phone_number.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.phone_number.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.email.id_for_label }}" class="form-label">Church Email *</label>
                            {{ form.email }}
                            {% if form.email.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.email.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.website.id_for_label }}" class="form-label">Website</label>
                            {{ form.website }}
                            {% if form.website.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.website.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.established_date.id_for_label }}" class="form-label">Established Date</label>
                            {{ form.established_date }}
                            {% if form.established_date.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.established_date.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Leadership Information Tab -->
                <div class="tab-content" id="leadership-info" style="display: none;">
                    <h5 class="mb-3">
                        <i class="fas fa-user-tie me-2"></i>Leadership Information
                    </h5>
                    
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.senior_pastor_name.id_for_label }}" class="form-label">Senior Pastor Name *</label>
                            {{ form.senior_pastor_name }}
                            {% if form.senior_pastor_name.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.senior_pastor_name.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.senior_pastor_phone.id_for_label }}" class="form-label">Pastor Phone</label>
                            {{ form.senior_pastor_phone }}
                            {% if form.senior_pastor_phone.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.senior_pastor_phone.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.senior_pastor_email.id_for_label }}" class="form-label">Pastor Email</label>
                            {{ form.senior_pastor_email }}
                            {% if form.senior_pastor_email.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.senior_pastor_email.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Address Information Tab -->
                <div class="tab-content" id="address-info" style="display: none;">
                    <h5 class="mb-3">
                        <i class="fas fa-map-marker-alt me-2"></i>Church Address
                    </h5>
                    
                    <div class="mb-3">
                        <label for="{{ form.address_line1.id_for_label }}" class="form-label">Address Line 1 *</label>
                        {{ form.address_line1 }}
                        {% if form.address_line1.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.address_line1.errors.0 }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.address_line2.id_for_label }}" class="form-label">Address Line 2</label>
                        {{ form.address_line2 }}
                        {% if form.address_line2.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.address_line2.errors.0 }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.city.id_for_label }}" class="form-label">City *</label>
                            {{ form.city }}
                            {% if form.city.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.city.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.county.id_for_label }}" class="form-label">County *</label>
                            {{ form.county }}
                            {% if form.county.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.county.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.postal_code.id_for_label }}" class="form-label">Postal Code</label>
                            {{ form.postal_code }}
                            {% if form.postal_code.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.postal_code.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Documents Tab -->
                <div class="tab-content" id="documents" style="display: none;">
                    <h5 class="mb-3">
                        <i class="fas fa-file-upload me-2"></i>Legal Documents
                    </h5>
                    <p class="text-muted mb-4">
                        Upload the necessary legal documents for your church. 
                        <strong>Registration Certificate is required.</strong>
                    </p>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.registration_certificate.id_for_label }}" class="form-label">
                                Registration Certificate * 
                                <span class="text-danger">(Required)</span>
                            </label>
                            {{ form.registration_certificate }}
                            <small class="form-text text-muted">{{ form.registration_certificate.help_text }}</small>
                            {% if form.registration_certificate.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.registration_certificate.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.tax_exemption.id_for_label }}" class="form-label">Tax Exemption Certificate</label>
                            {{ form.tax_exemption }}
                            <small class="form-text text-muted">{{ form.tax_exemption.help_text }}</small>
                            {% if form.tax_exemption.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.tax_exemption.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.constitution.id_for_label }}" class="form-label">Church Constitution/Bylaws</label>
                            {{ form.constitution }}
                            <small class="form-text text-muted">{{ form.constitution.help_text }}</small>
                            {% if form.constitution.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.constitution.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.pastor_appointment.id_for_label }}" class="form-label">Pastor Appointment Letter</label>
                            {{ form.pastor_appointment }}
                            <small class="form-text text-muted">{{ form.pastor_appointment.help_text }}</small>
                            {% if form.pastor_appointment.errors %}
                                <div class="text-danger small mt-1">
                                    {{ form.pastor_appointment.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6><i class="fas fa-info-circle me-2"></i>Document Requirements</h6>
                        <ul class="mb-0">
                            <li><strong>Registration Certificate:</strong> Official certificate from government authorities</li>
                            <li><strong>Tax Exemption:</strong> Certificate if your church has tax-exempt status</li>
                            <li><strong>Constitution/Bylaws:</strong> Governing documents of your church</li>
                            <li><strong>Pastor Appointment:</strong> Official letter appointing the senior pastor</li>
                        </ul>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <ul class="nav nav-tabs mb-4" id="churchTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#church-info" type="button" role="tab" aria-controls="church-info" aria-selected="true">
                            <i class="fas fa-church me-2"></i>Church Info
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#leadership-info" type="button" role="tab" aria-controls="leadership-info" aria-selected="false">
                            <i class="fas fa-user-tie me-2"></i>Leadership
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#address-info" type="button" role="tab" aria-controls="address-info" aria-selected="false">
                            <i class="fas fa-map-marker-alt me-2"></i>Address
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#documents" type="button" role="tab" aria-controls="documents" aria-selected="false">
                            <i class="fas fa-file-upload me-2"></i>Documents
                        </button>
                    </li>
                </ul>

                <div class="d-grid">
                    <button type="submit" class="btn btn-primary auth-btn">
                        <i class="fas fa-church me-2"></i>Register Church
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab functionality
    const tabButtons = document.querySelectorAll('#churchTabs button[data-bs-toggle="tab"]');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all tabs and contents
            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.style.display = 'none');
            
            // Add active class to clicked tab
            this.classList.add('active');
            
            // Show corresponding content
            const targetId = this.getAttribute('data-bs-target');
            const targetContent = document.querySelector(targetId);
            if (targetContent) {
                targetContent.style.display = 'block';
            }
        });
    });
});
</script>
{% endblock %}
